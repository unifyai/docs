---
title: 'preprocess_messages_for_anthropic'
---

```python
def preprocess_messages_for_anthropic(
    messages: List[Dict[str, Any]],
) -> List[Dict[str, Any]]:
```

<p align="right">[source code](https://github.com/unifyai/unify/tree/f9cdf2e53054097d485d787daa51b4f704c9025c/unify/universal_api/utils/provider_preprocessing.py#L172)</p>

Apply Anthropic-specific preprocessing to messages.This performs the following transformations:
1. Move all system messages to the beginning of the list
2. Combine adjacent user messages into content array format
3. If any user messages were combined, append an explanation system message

**Arguments**:

- `messages` - List of message dictionaries.



**Returns**:

Preprocessed messages (a new list, original is not modified).